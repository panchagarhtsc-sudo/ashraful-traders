<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>এডমিন প্যানেল - আশরাফুল ট্রেডার্স</title>
    
    <!-- Firebase v12 SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
        
        // আপনার Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCzJpOpEq2HBkWoelWz7qabFJVnsRC26Bc",
            authDomain: "ashraful-traders-e7b3a.firebaseapp.com",
            projectId: "ashraful-traders-e7b3a",
            storageBucket: "ashraful-traders-e7b3a.firebasestorage.app",
            messagingSenderId: "740817840351",
            appId: "1:740817840351:web:a030138e21df4c166a216a"
        };

        // Firebase শুরু করুন
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global variables (পুরো ফাইলে ব্যবহারের জন্য)
        window.firebaseAuth = auth;
        window.firebaseDB = db;
        window.firebaseApp = app;
        window.firebaseModules = {
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            collection,
            addDoc,
            getDocs,
            updateDoc,
            deleteDoc,
            doc,
            query,
            orderBy,
            serverTimestamp
        };

        console.log("✅ Firebase v12 initialized successfully!");
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Hind Siliguri', sans-serif;
        }

        :root {
            --primary: #2e7d32;
            --primary-dark: #1b5e20;
            --secondary: #ff9800;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --white: #ffffff;
            --danger: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --info: #3498db;
            --gray: #7f8c8d;
        }

        body {
            background: #f5f7fa;
            color: var(--dark);
            min-height: 100vh;
        }

        /* লগইন পেজ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 20px;
        }

        .login-box {
            background: var(--white);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }

        .login-logo {
            margin-bottom: 30px;
        }

        .login-logo i {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .login-title {
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .login-subtitle {
            color: var(--gray);
            margin-bottom: 30px;
            font-size: 1rem;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 125, 50, 0.3);
        }

        .btn-secondary {
            background: var(--gray);
            color: var(--white);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-info {
            background: var(--info);
            color: var(--white);
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
            text-align: center;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .message.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            display: block;
        }

        /* লোডিং স্পিনার */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* রেস্পন্সিভ */
        @media (max-width: 576px) {
            .login-box {
                padding: 30px 20px;
            }
            
            .login-logo i {
                font-size: 3rem;
            }
            
            .login-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- লগইন পেজ -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-logo">
                <i class="fas fa-seedling"></i>
                <h1 class="login-title">আশরাফুল ট্রেডার্স</h1>
                <p class="login-subtitle">কৃষকের আস্থার ঠিকানা</p>
                <p class="login-subtitle" style="font-size: 0.9rem; margin-top: 10px;">এডমিন প্যানেল (Firebase v12)</p>
            </div>
            
            <div class="form-group">
                <label for="loginEmail"><i class="fas fa-envelope"></i> ইমেইল ঠিকানা</label>
                <input type="email" id="loginEmail" class="form-control" placeholder="admin@ashraful.com">
            </div>
            
            <div class="form-group">
                <label for="loginPassword"><i class="fas fa-lock"></i> পাসওয়ার্ড</label>
                <input type="password" id="loginPassword" class="form-control" placeholder="********">
            </div>
            
            <button onclick="login()" class="btn btn-primary">
                <i class="fas fa-sign-in-alt"></i> লগইন করুন
            </button>
            
            <div id="loginMessage" class="message"></div>
            
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                <h3 style="font-size: 1rem; margin-bottom: 10px; color: var(--dark);">ডেমো লগইন (টেস্টের জন্য):</h3>
                <p style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">
                    <strong>ইমেইল:</strong> admin@ashraful.com
                </p>
                <p style="font-size: 0.9rem; color: var(--gray);">
                    <strong>পাসওয়ার্ড:</strong> Admin@123
                </p>
            </div>
        </div>
    </div>

    <!-- ড্যাশবোর্ড (লগইনের পর দেখাবে) -->
    <div id="dashboard" style="display: none;">
        <!-- ড্যাশবোর্ড কন্টেন্ট -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
            <!-- হেডার -->
            <div style="background: var(--white); padding: 20px; border-radius: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                <div>
                    <h1 style="color: var(--primary-dark); margin-bottom: 5px;">
                        <i class="fas fa-seedling"></i> আশরাফুল ট্রেডার্স
                    </h1>
                    <p style="color: var(--gray);">এডমিন ড্যাশবোর্ড</p>
                </div>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span id="adminEmail" style="color: var(--gray);"></span>
                    <button onclick="logout()" class="btn btn-danger" style="width: auto; padding: 10px 20px;">
                        <i class="fas fa-sign-out-alt"></i> লগআউট
                    </button>
                </div>
            </div>

            <!-- ড্যাশবোর্ড গ্রিড -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: var(--white); padding: 25px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border-top: 4px solid var(--success);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="width: 50px; height: 50px; background: var(--success); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                            <i class="fas fa-box"></i>
                        </div>
                        <div>
                            <h3 style="font-size: 2rem; color: var(--dark);" id="totalProducts">০</h3>
                            <p style="color: var(--gray);">মোট পণ্য</p>
                        </div>
                    </div>
                </div>

                <div style="background: var(--white); padding: 25px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border-top: 4px solid var(--warning);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="width: 50px; height: 50px; background: var(--warning); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div>
                            <h3 style="font-size: 2rem; color: var(--dark);" id="totalOrders">০</h3>
                            <p style="color: var(--gray);">মোট অর্ডার</p>
                        </div>
                    </div>
                </div>

                <div style="background: var(--white); padding: 25px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border-top: 4px solid var(--info);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="width: 50px; height: 50px; background: var(--info); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <h3 style="font-size: 2rem; color: var(--dark);" id="totalCustomers">০</h3>
                            <p style="color: var(--gray);">মোট গ্রাহক</p>
                        </div>
                    </div>
                </div>

                <div style="background: var(--white); padding: 25px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border-top: 4px solid var(--danger);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="width: 50px; height: 50px; background: var(--danger); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div>
                            <h3 style="font-size: 2rem; color: var(--dark);" id="totalDue">০ টাকা</h3>
                            <p style="color: var(--gray);">মোট বাকি</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ট্যাব সিস্টেম -->
            <div style="background: var(--white); border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); overflow: hidden;">
                <!-- ট্যাব হেডার -->
                <div style="display: flex; background: var(--light); border-bottom: 1px solid #ddd;">
                    <button onclick="showTab('productsTab')" class="tab-btn active" style="flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--dark); border-bottom: 3px solid var(--primary);">
                        <i class="fas fa-box"></i> পণ্য ব্যবস্থাপনা
                    </button>
                    <button onclick="showTab('customersTab')" class="tab-btn" style="flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--gray);">
                        <i class="fas fa-users"></i> গ্রাহক ব্যবস্থাপনা
                    </button>
                    <button onclick="showTab('halkhataTab')" class="tab-btn" style="flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--gray);">
                        <i class="fas fa-book"></i> হালখাতা
                    </button>
                    <button onclick="showTab('settingsTab')" class="tab-btn" style="flex: 1; padding: 15px; background: none; border: none; cursor: pointer; font-weight: 600; color: var(--gray);">
                        <i class="fas fa-cog"></i> সেটিংস
                    </button>
                </div>

                <!-- পণ্য ব্যবস্থাপনা ট্যাব -->
                <div id="productsTab" class="tab-content" style="padding: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h2 style="color: var(--dark);">পণ্য ব্যবস্থাপনা</h2>
                        <button onclick="showProductForm()" class="btn btn-success" style="width: auto;">
                            <i class="fas fa-plus"></i> নতুন পণ্য যোগ করুন
                        </button>
                    </div>

                    <!-- পণ্য ফর্ম -->
                    <div id="productForm" style="display: none; background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 30px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>পণ্যের নাম</label>
                                <input type="text" id="productName" class="form-control" placeholder="পণ্যের নাম">
                            </div>
                            <div class="form-group">
                                <label>ক্যাটাগরি</label>
                                <select id="productCategory" class="form-control">
                                    <option value="">সিলেক্ট করুন</option>
                                    <option value="organic">জৈব বালাইনাশক</option>
                                    <option value="pesticide">কীটনাশক</option>
                                    <option value="weedicide">আগাছা নাশক</option>
                                    <option value="pgr">পিজিআর</option>
                                    <option value="fertilizer">সার</option>
                                    <option value="equipment">কৃষি যন্ত্রপাতি</option>
                                </select>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div class="form-group">
                                <label>কোম্পানি</label>
                                <input type="text" id="productCompany" class="form-control" placeholder="কোম্পানির নাম">
                            </div>
                            <div class="form-group">
                                <label>দাম (টাকা)</label>
                                <input type="number" id="productPrice" class="form-control" placeholder="দাম">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>বিবরণ</label>
                            <textarea id="productDescription" class="form-control" placeholder="পণ্যের বিবরণ" rows="3"></textarea>
                        </div>

                        <div class="form-group">
                            <label>স্টক পরিমাণ</label>
                            <input type="number" id="productStock" class="form-control" placeholder="স্টক">
                        </div>

                        <div style="display: flex; gap: 15px; margin-top: 20px;">
                            <button onclick="saveProduct()" class="btn btn-primary" style="width: auto;">
                                <i class="fas fa-save"></i> সংরক্ষণ করুন
                            </button>
                            <button onclick="cancelProductForm()" class="btn btn-secondary" style="width: auto;">
                                <i class="fas fa-times"></i> বাতিল করুন
                            </button>
                        </div>
                    </div>

                    <!-- পণ্য তালিকা -->
                    <div id="productsList" style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: var(--white);">
                            <thead style="background: var(--primary); color: white;">
                                <tr>
                                    <th style="padding: 15px; text-align: left;">পণ্যের নাম</th>
                                    <th style="padding: 15px; text-align: left;">ক্যাটাগরি</th>
                                    <th style="padding: 15px; text-align: left;">দাম</th>
                                    <th style="padding: 15px; text-align: left;">স্টক</th>
                                    <th style="padding: 15px; text-align: left;">অ্যাকশন</th>
                                </tr>
                            </thead>
                            <tbody id="productsTableBody">
                                <!-- পণ্য লোড হবে এখানে -->
                                <tr>
                                    <td colspan="5" style="padding: 20px; text-align: center; color: var(--gray);">
                                        <div class="spinner"></div>
                                        <p style="margin-top: 10px;">পণ্য লোড হচ্ছে...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- অন্যান্য ট্যাব (সংক্ষিপ্ত) -->
                <div id="customersTab" class="tab-content" style="padding: 30px; display: none;">
                    <h2 style="color: var(--dark); margin-bottom: 20px;">গ্রাহক ব্যবস্থাপনা</h2>
                    <p>এই সেকশন শীঘ্রই যোগ করা হবে...</p>
                </div>

                <div id="halkhataTab" class="tab-content" style="padding: 30px; display: none;">
                    <h2 style="color: var(--dark); margin-bottom: 20px;">হালখাতা ব্যবস্থাপনা</h2>
                    <p>এই সেকশন শীঘ্রই যোগ করা হবে...</p>
                </div>

                <div id="settingsTab" class="tab-content" style="padding: 30px; display: none;">
                    <h2 style="color: var(--dark); margin-bottom: 20px;">সেটিংস</h2>
                    <p>এই সেকশন শীঘ্রই যোগ করা হবে...</p>
                </div>
            </div>

            <!-- মেসেজ এলাকা -->
            <div id="dashboardMessage" class="message" style="margin-top: 20px;"></div>
        </div>
    </div>

    <!-- ফন্ট Awesome -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

    <!-- Firebase ফাংশন -->
    <script>
        // লগইন ফাংশন
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const messageDiv = document.getElementById('loginMessage');
            
            if (!email || !password) {
                showMessage(messageDiv, 'ইমেইল এবং পাসওয়ার্ড দিন', 'error');
                return;
            }
            
            showMessage(messageDiv, '<div class="spinner"></div> লগইন হচ্ছে...', 'warning');
            
            try {
                await window.firebaseModules.signInWithEmailAndPassword(
                    window.firebaseAuth, 
                    email, 
                    password
                );
                
                // লগইন সফল
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                document.getElementById('adminEmail').textContent = email;
                showMessage(messageDiv, '✅ লগইন সফল!', 'success');
                loadDashboardData();
                
            } catch (error) {
                let errorMessage = 'লগইন ব্যর্থ! ';
                
                if (error.code === 'auth/invalid-email') {
                    errorMessage += 'ইমেইল ঠিকানা সঠিক নয়।';
                } else if (error.code === 'auth/user-not-found') {
                    errorMessage += 'এই ইমেইলে কোনো অ্যাকাউন্ট নেই।';
                } else if (error.code === 'auth/wrong-password') {
                    errorMessage += 'পাসওয়ার্ড ভুল।';
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage += 'অনেকবার চেষ্টা করা হয়েছে। পরে আবার চেষ্টা করুন।';
                } else {
                    errorMessage += error.message;
                }
                
                showMessage(messageDiv, '❌ ' + errorMessage, 'error');
            }
        }

        // লগআউট ফাংশন
        async function logout() {
            try {
                await window.firebaseModules.signOut(window.firebaseAuth);
                document.getElementById('dashboard').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
                showMessage(document.getElementById('loginMessage'), '✅ সফলভাবে লগআউট হয়েছে', 'success');
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // ড্যাশবোর্ড ডাটা লোড
        async function loadDashboardData() {
            try {
                // পণ্য কাউন্ট
                const productsQuery = window.firebaseModules.query(
                    window.firebaseModules.collection(window.firebaseDB, 'products')
                );
                const productsSnapshot = await window.firebaseModules.getDocs(productsQuery);
                document.getElementById('totalProducts').textContent = productsSnapshot.size;
                
                // পণ্য তালিকা লোড
                loadProducts();
                
                // অন্যান্য ডাটা (ডেমো)
                document.getElementById('totalOrders').textContent = '৫';
                document.getElementById('totalCustomers').textContent = '২৪';
                document.getElementById('totalDue').textContent = '১৫,৫০০ টাকা';
                
            } catch (error) {
                console.error('Error loading dashboard data:', error);
                showMessage(document.getElementById('dashboardMessage'), '❌ ডাটা লোড করতে সমস্যা: ' + error.message, 'error');
            }
        }

        // পণ্য লোড
        async function loadProducts() {
            try {
                const productsQuery = window.firebaseModules.query(
                    window.firebaseModules.collection(window.firebaseDB, 'products'),
                    window.firebaseModules.orderBy('timestamp', 'desc')
                );
                const snapshot = await window.firebaseModules.getDocs(productsQuery);
                const tbody = document.getElementById('productsTableBody');
                
                if (snapshot.empty) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="padding: 30px; text-align: center; color: var(--gray);">
                                <i class="fas fa-box-open" style="font-size: 3rem; margin-bottom: 15px; color: #ddd;"></i>
                                <p style="font-size: 1.1rem;">কোনো পণ্য নেই</p>
                                <p style="font-size: 0.9rem; margin-top: 5px;">নতুন পণ্য যোগ করুন</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                let html = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    html += `
                        <tr style="border-bottom: 1px solid #eee;">
                            <td style="padding: 15px;">
                                <strong>${data.name || ''}</strong><br>
                                <small style="color: var(--gray);">${data.company || ''}</small>
                            </td>
                            <td style="padding: 15px;">
                                <span style="background: #e3f2fd; color: #1976d2; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">
                                    ${getCategoryName(data.category)}
                                </span>
                            </td>
                            <td style="padding: 15px; font-weight: bold; color: var(--success);">
                                ${data.price || 0} টাকা
                            </td>
                            <td style="padding: 15px;">
                                <span style="background: ${data.stock > 10 ? '#e8f5e9' : '#ffebee'}; color: ${data.stock > 10 ? '#2e7d32' : '#d32f2f'}; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">
                                    ${data.stock || 0} পিস
                                </span>
                            </td>
                            <td style="padding: 15px;">
                                <button onclick="editProduct('${doc.id}')" style="background: var(--warning); color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; margin-right: 5px;">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteProduct('${doc.id}')" style="background: var(--danger); color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
                
                tbody.innerHTML = html;
                
            } catch (error) {
                console.error('Error loading products:', error);
                showMessage(document.getElementById('dashboardMessage'), '❌ পণ্য লোড করতে সমস্যা: ' + error.message, 'error');
            }
        }

        // পণ্য সেভ
        async function saveProduct() {
            const name = document.getElementById('productName').value;
            const category = document.getElementById('productCategory').value;
            const company = document.getElementById('productCompany').value;
            const price = document.getElementById('productPrice').value;
            const description = document.getElementById('productDescription').value;
            const stock = document.getElementById('productStock').value;
            const messageDiv = document.getElementById('dashboardMessage');
            
            if (!name || !category || !price) {
                showMessage(messageDiv, 'পণ্যের নাম, ক্যাটাগরি এবং দাম দিন', 'error');
                return;
            }
            
            try {
                await window.firebaseModules.addDoc(
                    window.firebaseModules.collection(window.firebaseDB, 'products'),
                    {
                        name: name,
                        category: category,
                        company: company,
                        price: parseFloat(price),
                        description: description,
                        stock: parseInt(stock) || 0,
                        timestamp: window.firebaseModules.serverTimestamp()
                    }
                );
                
                showMessage(messageDiv, '✅ পণ্য সফলভাবে সংরক্ষিত হয়েছে!', 'success');
                cancelProductForm();
                loadProducts();
                loadDashboardData();
                
            } catch (error) {
                showMessage(messageDiv, '❌ পণ্য সংরক্ষণ ব্যর্থ: ' + error.message, 'error');
            }
        }

        // পণ্য ফর্ম শো/হাইড
        function showProductForm() {
            document.getElementById('productForm').style.display = 'block';
            document.getElementById('productName').focus();
        }

        function cancelProductForm() {
            document.getElementById('productForm').style.display = 'none';
            document.getElementById('productName').value = '';
            document.getElementById('productCategory').value = '';
            document.getElementById('productCompany').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productDescription').value = '';
            document.getElementById('productStock').value = '';
        }

        // পণ্য এডিট
        function editProduct(productId) {
            showMessage(document.getElementById('dashboardMessage'), 'এডিট ফিচার শীঘ্রই যোগ করা হবে', 'warning');
        }

        // পণ্য ডিলিট
        async function deleteProduct(productId) {
            if (confirm('আপনি কি এই পণ্য ডিলিট করতে চান?')) {
                try {
                    await window.firebaseModules.deleteDoc(
                        window.firebaseModules.doc(window.firebaseDB, 'products', productId)
                    );
                    showMessage(document.getElementById('dashboardMessage'), '✅ পণ্য সফলভাবে ডিলিট করা হয়েছে', 'success');
                    loadProducts();
                    loadDashboardData();
                } catch (error) {
                    showMessage(document.getElementById('dashboardMessage'), '❌ পণ্য ডিলিট ব্যর্থ: ' + error.message, 'error');
                }
            }
        }

        // ট্যাব পরিবর্তন
        function showTab(tabId) {
            // সব ট্যাব লুকান
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // সব ট্যাব বাটন রিসেট
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.style.color = 'var(--gray)';
                btn.style.borderBottom = 'none';
            });
            
            // নির্বাচিত ট্যাব দেখান
            document.getElementById(tabId).style.display = 'block';
            event.target.style.color = 'var(--dark)';
            event.target.style.borderBottom = '3px solid var(--primary)';
        }

        // ক্যাটাগরি নাম
        function getCategoryName(category) {
            const categories = {
                'organic': 'জৈব বালাইনাশক',
                'pesticide': 'কীটনাশক',
                'weedicide': 'আগাছা নাশক',
                'pgr': 'পিজিআর',
                'fertilizer': 'সার',
                'equipment': 'কৃষি যন্ত্রপাতি'
            };
            return categories[category] || category;
        }

        // মেসেজ শো
        function showMessage(element, message, type) {
            element.innerHTML = `<div class="${type}">${message}</div>`;
            setTimeout(() => {
                element.innerHTML = '';
            }, 5000);
        }

        // অটো লগইন চেক
        window.firebaseModules.onAuthStateChanged(window.firebaseAuth, (user) => {
            if (user) {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                document.getElementById('adminEmail').textContent = user.email;
                loadDashboardData();
            } else {
                document.getElementById('dashboard').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
            }
        });

        // Enter key press এ লগইন
        document.getElementById('loginPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });
    </script>
</body>
</html>